<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.11.1/sha256.min.js" integrity="sha512-YVITnHZw4RIWJdL3B3qiUUjFwe2999f7+GY9p75emmKu62hze4Tr1hSG5SSDPAp1WaMMbjGOZL9YaNzO5UDpYg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <a href="https://dirkarnez.github.io/duplicate-file-finder/" target="_blank"></a><br>
    <button id="start">start</button>
    <script>
        // [使用FileReader.readAsArrayBuffer()在浏览器中处理大文件](https://joji.me/zh-cn/blog/processing-huge-files-using-filereader-readasarraybuffer-in-web-browser/)
        async function getChecksumSha256(blob: Blob) {
          const uint8Array = new Uint8Array(await blob.arrayBuffer());
          const hashBuffer = await crypto.subtle.digest('SHA-256', uint8Array);
          const hashArray = Array.from(new Uint8Array(hashBuffer));
        
          return hashArray.map((h) => h.toString(16).padStart(2, '0')).join('');
        }
        
        document.getElementById("start", async () => {
          const handle = await window.showDirectoryPicker();
          for await (const a of handle.entries()) {
            debugger;
              window.sha256("123")
          }
            for await (const [key, value] of handle.entries()) {
                const fileData = await value.getFile();
                debugger;
              console.log({ key, value });
            }
        });
    </script>
</body>
</html>
